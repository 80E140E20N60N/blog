(window.webpackJsonp=window.webpackJsonp||[]).push([[114],{537:function(s,a,t){"use strict";t.r(a);var n=t(23),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"异步promise原理-以及新特性async-await"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#异步promise原理-以及新特性async-await"}},[s._v("#")]),s._v(" 异步Promise原理 以及新特性async/await")]),s._v(" "),t("p",[s._v("当拿到一段 JS 代码时，浏览器或者 Node 环境首先要做的就是将其传递给 JS 引擎，并要求它去执行。此外，宿主环境还会提供 API 给 JS 引擎，比如 setTimeout 这样的 API，它会允许 JS 在特定的时机执行。")]),s._v(" "),t("p",[s._v("在 ES3 及更早版本，JavaScript 本身还没有异步执行代码的能力，所以宿主环境传递给 JS 引擎的代码会直接顺次执行（旧方案是单纯使用回调函数来异步编程 ？）。但是，ES6将Promise列为正式规范，这样无需宿主的安排，JS 引擎本身也可以发起任务。")]),s._v(" "),t("h2",{attrs:{id:"宏观和微观任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#宏观和微观任务"}},[s._v("#")]),s._v(" 宏观和微观任务")]),s._v(" "),t("p",[s._v("在 JavaScript 中，我们把宿主发起的任务称为「宏观任务」，把 JS 引擎发起的任务称为「微观任务」。")]),s._v(" "),t("p",[s._v("JavaScript 引擎等待宿主环境分配宏观任务，在宏观任务中，JS 的 Promise 还会产生异步代码，JS 必须保证这些异步代码在一个宏观任务中完成，因此每个宏观任务中又包含了一个「微观任务队列」。有了「宏观任务」和「微观任务」之后，我们就可以实现 JS 引擎级和宿主级的任务了。例如，Promise 永远在队列尾部添加「微观任务」。setTimeout 等宿主的 API 会添加「宏观任务」。")]),s._v(" "),t("h2",{attrs:{id:"promise"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#promise"}},[s._v("#")]),s._v(" Promise")]),s._v(" "),t("p",[s._v("Promise 是异步编程的一种解决方案，Promise简单说就是一个容器，里面保存着某个未来才会结束的事件（通常是一个异步操作）的结果。")]),s._v(" "),t("h2",{attrs:{id:"新特性-async-await"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#新特性-async-await"}},[s._v("#")]),s._v(" 新特性：async/await")]),s._v(" "),t("p",[s._v("async/await 是 ES6 中新加入的特性。async 函数必定返回 Promise，我们把所有返回 Promise 的函数都可认为是异步函数。\nasync 是一种特殊语法，在 function 关键字前加上 async 关键字，这样就定义了一个 async 函数，在函数中使用 await 来等待一个 Promise。")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"b"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);